WITH t1 AS(
  SELECT
    f.film_id,
    f.title,
    count(r.rental_id)
  FROM
    rental r
    JOIN inventory i ON i.inventory_id = r.inventory_id
    JOIN film f ON i.film_id = f.film_id
    JOIN film_category fc ON f.film_id = fc.film_id
    JOIN category c ON fc.category_id = c.category_id
  GROUP BY
    f.title,
    f.film_id
)
SELECT
  title film_title,
  c.name category_name,
  count rental_count
FROM
  t1
  JOIN film_category fc ON t1.film_id = fc.film_id
  JOIN category c ON c.category_id = fc.category_id
WHERE
  c.name IN (
    'Animation',
    'Children',
    'Classics',
    'Comedy',
    'Family',
    'Music'
  )
ORDER BY
  category_name,
  title