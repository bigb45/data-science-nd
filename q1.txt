with t1 as(select f.film_id, f.title, count(r.rental_id)
  from rental r
  join inventory i
  on i.inventory_id = r.inventory_id
  join film f
  on i.film_id = f.film_id
  join film_category fc
  on f.film_id = fc.film_id
  join category c 
  on fc.category_id = c.category_id 
  group by f.title, f.film_id)
select title film_title, c.name category_name, count rental_count
from t1
join film_category fc
on t1.film_id = fc.film_id
join category c
on c.category_id = fc.category_id
where c.name IN ('Animation', 'Children', 'Classics', 'Comedy', 'Family','Music')
order by category_name, title